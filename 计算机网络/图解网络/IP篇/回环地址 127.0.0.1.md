# 什么是127.0.0.1
`IPV4`地址中，**127 开头的都属于回环地址**，也是 `IPV4` 的特殊地址，没什么道理，就是人为规定的。

而`127.0.0.1`是**众多**回环地址中的一个。之所以不是 `127.0.0.2` ，而是 `127.0.0.1`，是因为源码里就是这么定义的，也没什么道理。

# 为什么断网了还能 ping 通 127.0.0.1
数据报会根据目标IP选择对应网卡进行发送：
- 当发现**目标IP是外网IP**时，会从"真网卡"发出。
- 当发现**目标IP是回环地址**时，就会选择**本地网卡**。

本地网卡，其实就是个"假网卡"，它不像"真网卡"那样有个`ring buffer`什么的，"假网卡"会把数据推到一个叫 `input_pkt_queue` 的 链表 中。这个链表，其实是所有网卡共享的，上面挂着发给本机的各种消息。消息被发送到这个链表后，会再触发一个**软中断**。

可以理解为，消息发出到这个地址上的话，就不会出网络，在本机打个转就又回来了。**所以断网，依然能 `ping` 通 `127.0.0.1`。
![[Pasted image 20240221112154.png]]

# ping回环地址和ping本机地址有什么区别
在linux中执行`ifconfig` 。
```shell
$ ifconfig
lo0: flags=8049<UP,LOOPBACK,RUNNING,MULTICAST> mtu 16384
    inet 127.0.0.1 netmask 0xff000000
    ...
en0: flags=8863<UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST> mtu 1500
    inet 192.168.31.6 netmask 0xffffff00 broadcast 192.168.31.255
    ...
```
能看到 **lo0**，表示本地回环接口，对应的地址，就是我们前面提到的 **127.0.0.1** ，也就是**回环地址**。
和 **eth0**，表示本机第一块网卡，对应的IP地址是**192.168.31.6**，管它叫**本机IP**。

事实上ping本机地址同样会走回环地址中的假网卡，也就是和ping回环地址没有区别。

# 127.0.0.1 和 localhost 以及 0.0.0.0 有区别吗
- `localhost` 就不叫 `IP`，它是一个域名，只不过默认会把它解析为 `127.0.0.1` ，当然这可以在 `/etc/hosts` 文件下进行修改。
- `0.0.0.0` ,表示本机上的**所有IPV4地址**。执行 `ping 0.0.0.0` ，是会失败的，因为它在`IPV4`中表示的是无效的**目标地址**。

