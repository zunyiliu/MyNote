# 什么是 RPC ?
RPC Remote Procedure Call）远程过程调用协议，是一种软件通信协议，一个程序可以用来向位于网络上另一台计算机的程序请求服务，而不必了解网络的细节。RPC 被用来像本地系统一样调用远程系统上的其他进程。过程调用有时也被称为函数调用或子程序调用。

# 为什么有 RPC？
1：服务化/微服务 2：分布式系统架构 3：服务可重用 4：系统间交互调用

RPC可以实现这样一种编程模式：
客户端将进行在它看来是正常的过程调用，然后客户端会将其打包成网络消息并传送给服务器。服务器会将其解包，并在服务器端将其转回为过程调用，这个调用的结果将被打包，以便返回给客户端。

# RPC 如何工作
![[Pasted image 20240120094912.png]]
RPC 的工作过程如下：
1. 服务消费方（client）调用以本地调用方式调用服务；
2. client stub 接收到调用后负责将方法、参数等组装成能够进行网络传输的消息体；这就是所谓的marshalling。
3. client stub 找到服务地址，并将消息发送到服务端；这个过程可能是面向连接或无连接的。
4. server stub 收到消息后进行解码；也叫 unmarshalling。
5. server stub 根据解码结果调用本地的服务；
6. 本地服务执行并将结果返回给 server stub ；
7. server stub 将返回结果打包成消息并发送至消费方；
8. client stub 接收到消息，并进行解码；
9. 服务消费方得到最终结果。并且返回值被设置在本地进程的堆栈中。

## 通信
RPC框架的通信与具体的协议无关，RPC可基于HTTP或者TCP协议

## 序列化
传输方式和序列化会直接影响RPC的性能
![[Pasted image 20240120095058.png]]
